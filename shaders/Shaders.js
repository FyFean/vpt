(function(global) { Shaders = {"average":{"vertex":"#version 300 es\nprecision mediump float;\n\nin vec2 aPosition;\nout vec2 vFragmentPosition;\n\nvoid main() {\n\tgl_Position = vec4(aPosition, 0.0, 1.0);\n\tvFragmentPosition = (aPosition + vec2(1.0, 1.0)) * 0.5;\n}","fragment":"#version 300 es\nprecision mediump float;\n\nuniform mediump sampler2D uTextureAccumulator;\nuniform mediump sampler2D uTextureNew;\nuniform float uInvn; // inverse number of samples\n\nin vec2 vFragmentPosition;\nout vec4 color;\n\nvoid main() {\n\tvec4 a = texture(uTextureAccumulator, vFragmentPosition);\n\tvec4 b = texture(uTextureNew, vFragmentPosition);\n\tcolor = a + (b - a) * uInvn;\n}"},"mip":{"vertex":"#version 300 es\nprecision mediump float;\n\nlayout(location = 0) in vec2 aPosition;\nout vec2 vFragmentPosition;\n\nvoid main() {\n\tgl_Position = vec4(aPosition, 0.0, 1.0);\n\tvFragmentPosition = aPosition;\n}","fragment":"#version 300 es\nprecision mediump float;\n\nuniform float uTime;\nuniform mediump sampler3D uVolume;\n\n// camera\nuniform vec3 uPosition;\nuniform vec3 uDirection;\nuniform vec3 uUp;\nuniform vec3 uRight;\nuniform float uFov;\nuniform float uAsr;\nuniform float uFocalDistance;\nuniform float uFocalPerturbation;\nuniform float uExposure;\n\n// TODO: interpolate ray direction without perturbation\nin vec2 vFragmentPosition;\nout vec4 color;\n\nvec2 intersectCube(vec3 origin, vec3 direction) {\n\tvec3 tmin = (vec3(-1.0, -1.0, -1.0) - origin) / direction;\n\tvec3 tmax = (vec3( 1.0,  1.0,  1.0) - origin) / direction;\n\tvec3 t1 = min(tmin, tmax);\n\tvec3 t2 = max(tmin, tmax);\n\tfloat tnear = max(max(t1.x, t1.y), t1.z);\n\tfloat tfar = min(min(t2.x, t2.y), t2.z);\n\treturn vec2(tnear, tfar);\n}\n\nvoid main() {\n\tvec3 origin = uPosition;\n\tvec3 direction = uDirection + (vFragmentPosition.x * uFov) * uRight + (vFragmentPosition.y * uFov / uAsr) * uUp;\n\tvec2 t = max(intersectCube(origin, direction), 0.0);\n\tt.x = min(t.x, t.y);\n\tfloat val = 0.0;\n\tfloat tt = 0.0;\n\tdo {\n\t\tvec3 pos = ((origin + direction * mix(t.x, t.y, tt)) + 1.0) * 0.5;\n\t\tval = max(val, texture(uVolume, pos).r);\n\t\ttt += 0.02;\n\t} while (tt < 1.0);\n\t//color = vec4(1.0 - val, 1.0 - val, 1.0 - val, 1.0);\n\tcolor = vec4(val, val, val, 1.0);\n}"},"quad":{"vertex":"#version 300 es\nprecision mediump float;\n\nin vec2 aPosition;\nout vec2 vFragmentPosition;\n\nvoid main() {\n\tgl_Position = vec4(aPosition, 0.0, 1.0);\n\tvFragmentPosition = (aPosition + vec2(1.0, 1.0)) * 0.5;\n}","fragment":"#version 300 es\nprecision mediump float;\n\nuniform mediump sampler2D uTexture;\n\nin vec2 vFragmentPosition;\nout vec4 color;\n\nvoid main() {\n\tcolor = texture(uTexture, vFragmentPosition);\n}"}};})(this);